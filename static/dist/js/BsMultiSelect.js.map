{"version":3,"file":"BsMultiSelect.js","sources":["../../js/src/Bs4AdapterCss.js","../../js/src/Bs4AdapterJs.js","../../js/src/MultiSelect.js","../../js/src/AddToJQueryPrototype.js","../../js/src/Bs4Adapter.js","../../js/src/OptionsAdapterElement.js","../../js/src/OptionsAdapterJson.js","../../js/src/BsMultiSelect.js"],"sourcesContent":["class Bs4AdapterCss {\r\n\r\n    constructor(configuration, $) {\r\n        const defaults = {\r\n            selectedPanelFocusClass : 'focus',\r\n            selectedPanelDisabledClass: 'disabled',\r\n            selectedItemContentDisabledClass: 'disabled',\r\n            dropDownItemDisabledClass: 'disabled'\r\n        };\r\n        let tmp = $.extend({}, defaults, configuration);\r\n        this.configuration = $.extend(configuration, tmp);\r\n    }\r\n\r\n    DisableSelectedItemContent($content){\r\n        $content.addClass(this.configuration.selectedItemContentDisabledClass )\r\n    }\r\n\r\n    DisabledStyle($checkBox, isDisbaled){\r\n        if (isDisbaled) \r\n            $checkBox.addClass(this.configuration.dropDownItemDisabledClass);\r\n        else\r\n            $checkBox.removeClass(this.configuration.dropDownItemDisabledClass);\r\n    }\r\n\r\n    Enable($selectedPanel){\r\n        $selectedPanel.removeClass(this.configuration.selectedPanelDisabledClass)\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        $selectedPanel.addClass(this.configuration.selectedPanelDisabledClass)\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        $selectedPanel.addClass(this.configuration.selectedPanelFocusClass);\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n        $selectedPanel.removeClass(this.configuration.selectedPanelFocusClass);\r\n    }\r\n}\r\n\r\nexport default Bs4AdapterCss;\r\n","const defSelectedPanelStyle = {'margin-bottom': '0', 'height': 'auto'};\r\nconst defSelectedItemStyle = {'padding-left': '0px', 'line-height': '1.5em'};\r\nconst defRemoveSelectedItemButtonStyle = {'font-size':'1.5em', 'line-height': '.9em'};\r\n\r\nclass Bs4AdapterJs {\r\n    constructor(configuration, $) {\r\n        const defaults = {\r\n            selectedPanelDefMinHeight: 'calc(2.25rem + 2px)',\r\n            selectedPanelLgMinHeight:  'calc(2.875rem + 2px)',\r\n            selectedPanelSmMinHeight:  'calc(1.8125rem + 2px)',\r\n            selectedPanelDisabledBackgroundColor: '#e9ecef',\r\n            selectedPanelFocusBorderColor: '#80bdff',\r\n            selectedPanelFocusBoxShadow: '0 0 0 0.2rem rgba(0, 123, 255, 0.25)',\r\n            selectedPanelFocusValidBoxShadow: '0 0 0 0.2rem rgba(40, 167, 69, 0.25)',\r\n            selectedPanelFocusInvalidBoxShadow: '0 0 0 0.2rem rgba(220, 53, 69, 0.25)',\r\n            filterInputColor: '#495057',\r\n            selectedItemContentDisabledOpacity: '.65',\r\n            dropdDownLabelDisabledColor: '#6c757d'\r\n        };\r\n        let tmp = $.extend({}, defaults, configuration);\r\n        this.configuration = $.extend(configuration, tmp);\r\n    }\r\n\r\n    OnInit(dom){\r\n        dom.selectedPanel.css(defSelectedPanelStyle);\r\n        dom.filterInput.css(\"color\", this.configuration.filterInputColor);\r\n    }\r\n\r\n    \r\n    CreateSelectedItemContent($selectedItem, $button){\r\n        $selectedItem.css(defSelectedItemStyle);\r\n        $button.css(defRemoveSelectedItemButtonStyle);\r\n    }\r\n\r\n    DisableSelectedItemContent($content){\r\n        $content.css(\"opacity\", this.configuration.selectedItemContentDisabledOpacity )\r\n    }\r\n\r\n    DisabledStyle($checkBox, isDisbaled){\r\n        $checkBox.siblings('label').css('color', isDisbaled?this.configuration.dropdDownLabelDisabledColor:'')\r\n    }\r\n\r\n    UpdateSize($selectedPanel){\r\n        if ($selectedPanel.hasClass(\"form-control-lg\")){\r\n            $selectedPanel.css(\"min-height\", this.configuration.selectedPanelLgMinHeight);\r\n        } else if ($selectedPanel.hasClass(\"form-control-sm\")){\r\n            $selectedPanel.css(\"min-height\", this.configuration.selectedPanelSmMinHeight);\r\n        } else {\r\n            $selectedPanel.css(\"min-height\", this.configuration.selectedPanelDefMinHeight);\r\n        }\r\n    }\r\n\r\n    Enable($selectedPanel){\r\n        $selectedPanel.css({\"background-color\": \"\"})\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        $selectedPanel.css({\"background-color\": this.configuration.selectedPanelDisabledBackgroundColor})\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        if ($selectedPanel.hasClass(\"is-valid\")){\r\n            $selectedPanel.css(\"box-shadow\", this.configuration.selectedPanelFocusValidBoxShadow);\r\n        } else if ($selectedPanel.hasClass(\"is-invalid\")){\r\n            $selectedPanel.css(\"box-shadow\", this.configuration.selectedPanelFocusInvalidBoxShadow);\r\n        } else {\r\n            $selectedPanel\r\n                .css(\"box-shadow\", this.configuration.selectedPanelFocusBoxShadow)\r\n                .css(\"border-color\", this.configuration.selectedPanelFocusBorderColor);\r\n        }\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n            $selectedPanel.css(\"box-shadow\", \"\" ).css(\"border-color\", \"\")\r\n    }\r\n}\r\n\r\nexport default Bs4AdapterJs;\r\n","import Popper from 'popper.js'\r\n\r\nconst defSelectedPanelStyleSys = {'display':'flex', 'flex-wrap':'wrap', 'list-style-type':'none'};  // remove bullets since this is ul\r\nconst defFilterInputStyleSys   = {'width':'2ch', 'border':'0', 'padding':'0', 'outline':'none', 'background-color':'transparent' };\r\nconst defDropDownMenuStyleSys  = {'list-style-type':'none'}; // remove bullets since this is ul\r\n\r\n// jQuery used for:\r\n// $.extend, $.contains, $(\"<div>\"), $(function(){}) aka ready\r\n// $e.trigger, $e.unbind, $e.on; but namespaces are not used;\r\n// events: \"focusin\", \"focusout\", \"mouseover\", \"mouseout\", \"keydown\", \"keyup\", \"click\"\r\n// $e.show, $e.hide, $e.focus, $e.css\r\n// $e.appendTo, $e.remove, $e.find, $e.closest, $e.prev, $e.data, $e.val\r\n\r\nclass MultiSelect {\r\n    constructor(optionsAdapter, adapter, configuration, onDispose, window, $) {\r\n        if (typeof Popper === 'undefined') {\r\n            throw new TypeError('DashboardCode BsMultiSelect require Popper.js (https://popper.js.org)')\r\n        }\r\n        // readonly\r\n        this.adapter = adapter;\r\n        this.window = window;\r\n        this.document = window.document;\r\n        this.onDispose=onDispose;\r\n        this.$ = $;\r\n        \r\n        this.configuration = configuration;\r\n        \r\n        this.container = null;\r\n        this.selectedPanel = null;\r\n        this.filterInputItem = null;\r\n        this.filterInput = null;\r\n        this.dropDownMenu = null;\r\n        this.popper = null;\r\n        this.getDisabled=null;\r\n        // removable handlers\r\n        this.selectedPanelClick  = null;\r\n        this.documentMouseup   = null;\r\n        this.containerMousedown   = null;\r\n        this.documentMouseup2   = null;\r\n        // state\r\n        this.disabled=null;\r\n        this.filterInputItemOffsetLeft = null; // used to detect changes in input field position (by comparision with current value)\r\n        this.skipFocusout = false;\r\n        this.hoveredDropDownItem = null;\r\n        this.hoveredDropDownIndex = null;\r\n        this.hasDropDownVisible = false;\r\n\r\n        // jquery adapters\r\n        this.$document= $(this.document);\r\n\r\n        //this.createContainer();\r\n        optionsAdapter.init(this);\r\n    }\r\n    updateDropDownPosition(force) {\r\n        let offsetLeft = this.filterInputItem.offsetLeft;\r\n        if (force || this.filterInputItemOffsetLeft!=offsetLeft){\r\n            this.popper.update();\r\n            this.filterInputItemOffsetLeft=offsetLeft;\r\n        }\r\n    }\r\n    hideDropDown() {\r\n        this.dropDownMenu.style.display = 'none';\r\n    }\r\n    showDropDown() {\r\n        this.dropDownMenu.style.display = 'block';\r\n    }\r\n    // Public methods\r\n    resetDropDownMenuHover() {\r\n        if (this.hoveredDropDownItem !== null) {\r\n            this.adapter.HoverOut(this.$(this.hoveredDropDownItem));\r\n            this.hoveredDropDownItem = null;\r\n            this.hoveredDropDownIndex = null;\r\n        }\r\n    }\r\n\r\n    filterDropDownMenu() {\r\n        let text = this.filterInput.value.trim().toLowerCase();\r\n        let visible = 0;\r\n        this.$(this.dropDownMenu).find('LI').each((i, dropDownMenuItem) => {\r\n            let $dropDownMenuItem = this.$(dropDownMenuItem);\r\n            if (text == '') {\r\n                $dropDownMenuItem.show();\r\n                visible++;\r\n            }\r\n            else {\r\n                let itemText = $dropDownMenuItem.data(\"option-text\");\r\n                let option = $dropDownMenuItem.data(\"option\");\r\n                if (!option.selected && !option.hidden && !option.disabled && itemText.indexOf(text)>=0) {\r\n                    $dropDownMenuItem.show();\r\n                    visible++;\r\n                } else {\r\n                    $dropDownMenuItem.hide();\r\n                }\r\n            }\r\n        });\r\n        this.hasDropDownVisible = visible > 0;\r\n        this.resetDropDownMenuHover();\r\n        if (visible == 1) {\r\n            let visibleNodeListArray = this.getVisibleNodeListArray();\r\n            this.hoverInInternal(visibleNodeListArray, 0)\r\n        }\r\n    }\r\n\r\n    clearFilterInput(updatePosition) {\r\n        if (this.filterInput.value) {\r\n            this.filterInput.value = '';\r\n            this.input(updatePosition);\r\n        }\r\n    }\r\n\r\n    closeDropDown() {\r\n        this.resetDropDownMenuHover();\r\n        this.clearFilterInput(true);\r\n        this.hideDropDown();\r\n    }\r\n    \r\n    appendDropDownItem(optionElement, onChange) {\r\n        let isHidden = optionElement.hidden;\r\n        let itemText = optionElement.text;\r\n        let $dropDownItem = this.$(\"<LI/>\").prop(\"hidden\", isHidden)\r\n        $dropDownItem.data(\"option-text\", itemText.toLowerCase()).appendTo(this.dropDownMenu);\r\n        $dropDownItem.data(\"option\", optionElement);\r\n        \r\n        //let optionData = {\"optionId\":optionElement.value, \"itemText\": optionElement.text }\r\n        let adjustDropDownItem = this.adapter.CreateDropDownItemContent($dropDownItem, optionElement);\r\n        let isDisabled = optionElement.disabled;\r\n        let isSelected = optionElement.selected;\r\n\r\n        if (isSelected && isDisabled)\r\n            adjustDropDownItem.disabledStyle(true);\r\n        else if (isDisabled)\r\n            adjustDropDownItem.disable(isDisabled);\r\n       \r\n        adjustDropDownItem.onSelected(() => {\r\n            let toggleItem = $dropDownItem.data(\"option-toggle\");\r\n            toggleItem();\r\n            this.filterInput.focus();\r\n        });\r\n        \r\n        let selectItem = (doPublishEvents) => {\r\n            if (optionElement.hidden)\r\n                return;\r\n            let $selectedItem = this.$(\"<LI/>\")\r\n            \r\n            let adjustPair =(isSelected, toggle, remove) => {\r\n                optionElement.selected = isSelected;\r\n                adjustDropDownItem.select(isSelected);\r\n                $dropDownItem.data(\"option-toggle\", toggle);                    \r\n                $selectedItem.data(\"option-remove\", remove)\r\n            }\r\n\r\n            let removeItem = () => {\r\n                adjustDropDownItem.disabledStyle(false);\r\n                adjustDropDownItem.disable(optionElement.disabled);\r\n                adjustPair(\r\n                    false, \r\n                    () => {\r\n                        if (optionElement.disabled)\r\n                            return;\r\n                        selectItem(true);\r\n                    }, \r\n                    null\r\n                    )\r\n                $selectedItem.remove();\r\n                onChange();\r\n            };\r\n            \r\n            let removeItemAndCloseDropDown = () => {\r\n                removeItem();\r\n                this.closeDropDown();\r\n            };\r\n            this.adapter.CreateSelectedItemContent(\r\n                $selectedItem,\r\n                optionElement,\r\n                removeItemAndCloseDropDown,\r\n                this.disabled\r\n            );\r\n            adjustPair(true, removeItem, removeItemAndCloseDropDown);\r\n            $selectedItem.insertBefore(this.filterInputItem);\r\n            if (doPublishEvents){\r\n                onChange();\r\n            }\r\n        }\r\n\r\n        $dropDownItem\r\n            .mouseover(() => this.adapter.HoverIn($dropDownItem))\r\n            .mouseout(() => this.adapter.HoverOut($dropDownItem));\r\n        \r\n        if (optionElement.selected)\r\n            selectItem(false);\r\n        else\r\n            $dropDownItem.data(\"option-toggle\",  () => { \r\n                if (optionElement.disabled)\r\n                    return;\r\n                selectItem(true);\r\n            })\r\n    }\r\n    getVisibleNodeListArray(){\r\n        return this.$(this.dropDownMenu).find('LI:not([style*=\"display: none\"]):not(:hidden)').toArray();\r\n    }\r\n    hoverInInternal(visibleNodeListArray, index){\r\n        this.hoveredDropDownIndex = index;\r\n        this.hoveredDropDownItem = visibleNodeListArray[index];\r\n        this.adapter.HoverIn(this.$(this.hoveredDropDownItem));\r\n    }\r\n    keydownArrow(down) {\r\n        let visibleNodeListArray = this.getVisibleNodeListArray();\r\n        if (visibleNodeListArray.length > 0) {\r\n            if (this.hasDropDownVisible) {\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n            let index;\r\n            if (this.hoveredDropDownItem === null) {\r\n                index = down ? 0 : visibleNodeListArray.length - 1;\r\n            }\r\n            else {\r\n                this.adapter.HoverOut(this.$(this.hoveredDropDownItem));\r\n                if (down) {\r\n                    let newIndex = this.hoveredDropDownIndex + 1;\r\n                    index = newIndex < visibleNodeListArray.length ? newIndex : 0;\r\n                } else {\r\n                    let newIndex = this.hoveredDropDownIndex - 1;\r\n                    index = newIndex >= 0 ? newIndex : visibleNodeListArray.length - 1;\r\n                }\r\n            }\r\n            this.hoverInInternal(visibleNodeListArray, index);\r\n        }\r\n    }\r\n    input(forceUpdatePosition) {\r\n        this.filterInput.style.width = this.filterInput.value.length*1.3 + 2 + \"ch\";\r\n        this.filterDropDownMenu();\r\n\r\n        if (this.hasDropDownVisible) {\r\n            if (forceUpdatePosition) // ignore it if it is called from\r\n                this.updateDropDownPosition(forceUpdatePosition); // we need it to support case when textbox changes its place because of line break (texbox grow with each key press)\r\n            this.showDropDown();\r\n        } else {\r\n            this.hideDropDown();\r\n        }\r\n    }\r\n    Update(){\r\n        let $selectedPanel = this.$(this.selectedPanel);\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl(this.$(this.container), $selectedPanel);\r\n    }\r\n    Dispose(){\r\n        if (this.onDispose)\r\n            this.onDispose();\r\n        \r\n        // removable handlers\r\n        this.$document.unbind(\"mouseup\", this.documentMouseup)\r\n                      .unbind(\"mouseup\", this.documentMouseup2);\r\n        \r\n        if (this.adapter !== null) {\r\n            this.adapter.Dispose()\r\n        }\r\n        if (this.popper !== null) {\r\n            this.popper.destroy()\r\n        }\r\n        \r\n        if (this.removeContainer) {\r\n            this.removeContainer();\r\n        }\r\n    }\r\n    UpdateSize(){\r\n        this.UpdateSizeImpl(this.$(this.selectedPanel));\r\n    }\r\n    UpdateDisabled(){\r\n        this.UpdateDisabledImpl(this.$(this.container), this.$(this.selectedPanel));\r\n    }\r\n    UpdateSizeImpl($selectedPanel){\r\n        if (this.adapter.UpdateSize)\r\n            this.adapter.UpdateSize($selectedPanel);\r\n    }\r\n    UpdateDisabledImpl($container, $selectedPanel){\r\n        let disabled = this.getDisabled();\r\n        if (this.disabled!==disabled){\r\n            if (disabled) {\r\n                this.filterInput.style.display = \"none\";\r\n                this.adapter.Disable($selectedPanel);\r\n\r\n                $container.unbind(\"mousedown\", this.containerMousedown);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup);\r\n\r\n                $selectedPanel.unbind(\"click\", this.selectedPanelClick);\r\n                this.$document.unbind(\"mouseup\", this.documentMouseup2);\r\n                \r\n            } else {\r\n                this.filterInput.style.display = \"inline-block\";\r\n                this.adapter.Enable($selectedPanel);\r\n\r\n                $container.mousedown(this.containerMousedown);    // removable\r\n                this.$document.mouseup(this.documentMouseup); // removable\r\n\r\n                $selectedPanel.click(this.selectedPanelClick);     // removable\r\n                this.$document.mouseup(this.documentMouseup2); // removable\r\n            }\r\n            this.disabled=disabled;\r\n        }\r\n    }\r\n    fillContainer(container, removeContainer){\r\n        this.container=container;\r\n        this.removeContainer=removeContainer;\r\n        let $container = this.$(container);\r\n        this.selectedPanel = this.document.createElement(\"ul\");\r\n        let $selectedPanel = this.$(this.selectedPanel);\r\n        $selectedPanel.css(defSelectedPanelStyleSys);\r\n        $selectedPanel.appendTo(container);\r\n        let $filterInputItem = this.$('<LI/>');\r\n        this.filterInputItem = $filterInputItem.get(0)\r\n        $filterInputItem.appendTo(this.selectedPanel);\r\n        let $filterInput = this.$('<INPUT type=\"search\" autocomplete=\"off\">');\r\n        this.filterInput = $filterInput.get(0);\r\n        $filterInput.css(defFilterInputStyleSys);\r\n        $filterInput.appendTo(this.filterInputItem);\r\n        \r\n        let $dropDownMenu = this.$(\"<UL/>\").css({\"display\":\"none\"});\r\n        $dropDownMenu.appendTo(container);\r\n        this.dropDownMenu = $dropDownMenu.get(0);\r\n        \r\n        // prevent heavy understandable styling error\r\n        $dropDownMenu.css(defDropDownMenuStyleSys);\r\n        // create handlers\r\n        this.documentMouseup = () => {\r\n            this.skipFocusout = false;\r\n        }\r\n\r\n        this.containerMousedown = () => {\r\n            this.skipFocusout = true;\r\n        };\r\n        this.documentMouseup2 = event => {\r\n            if (!(container === event.target || this.$.contains(container, event.target))) {\r\n                this.closeDropDown();\r\n            }\r\n        }\r\n        this.selectedPanelClick = event => {\r\n            if (event.target.nodeName != \"INPUT\")\r\n                this.$(this.filterInput).val('').focus();\r\n            if (this.hasDropDownVisible && this.adapter.IsClickToOpenDropdown(event)){\r\n                this.updateDropDownPosition(true);\r\n                this.showDropDown();\r\n            }\r\n        };\r\n        this.adapter.Init({\r\n            container:$container, selectedPanel:$selectedPanel,\r\n            filterInputItem:$filterInputItem, filterInput:$filterInput,\r\n            dropDownMenu:$dropDownMenu });\r\n        return {$container, $selectedPanel, $dropDownMenu, $filterInput};\r\n    }\r\n\r\n    init($container, $selectedPanel, $dropDownMenu, $filterInput, onChange, getOptions, getDisabled) {\r\n        this.getDisabled=getDisabled;\r\n        this.popper = new Popper(this.filterInput, this.dropDownMenu, {\r\n            placement: 'bottom-start',\r\n            modifiers: {\r\n                preventOverflow: {enabled:false},\r\n                hide: {enabled:false},\r\n                flip: {enabled:false}\r\n                }\r\n        });\r\n        this.adapter.UpdateIsValid($selectedPanel);\r\n        this.UpdateSizeImpl($selectedPanel);\r\n        this.UpdateDisabledImpl($container, $selectedPanel);\r\n        // some browsers (IE11) can change select value (as part of \"autocomplete\") after page is loaded but before \"ready\" event\r\n        // FYI: $(() => { ...}) is jquery ready event shortcut\r\n        this.$(() => {\r\n            let options = getOptions();\r\n            this.$.each(options,\r\n                (index, el) => {\r\n                    this.appendDropDownItem(el, onChange);\r\n                }\r\n            );\r\n            this.hasDropDownVisible = options.length > 0;\r\n            this.updateDropDownPosition(false);\r\n        });\r\n        // there was unmotivated stopPropagation call. commented out.\r\n        // $dropDownMenu.click(  event => { \r\n        //    event.stopPropagation();\r\n        // });\r\n        $dropDownMenu.mouseover(() => this.resetDropDownMenuHover());\r\n\r\n        $filterInput.focusin(() => this.adapter.FocusIn($selectedPanel))\r\n                    .focusout(() => {\r\n                            if (!this.skipFocusout)\r\n                                this.adapter.FocusOut($selectedPanel)\r\n                            });\r\n        $filterInput.on(\"keydown\", (event) => {\r\n            if ([38, 40, 13].indexOf(event.which)>=0 || (event.which == 9 && this.filterInput.value) ) {\r\n                event.preventDefault();\r\n            }\r\n\r\n            if (event.which == 38) {\r\n                this.keydownArrow(false);\r\n            }\r\n            else if (event.which == 40) {\r\n                if (this.hoveredDropDownItem === null && this.hasDropDownVisible) {\r\n                    this.showDropDown();\r\n                }\r\n                this.keydownArrow(true);\r\n            }\r\n            else if (event.which == 9) {\r\n                if (!this.filterInput.value) {\r\n                    this.closeDropDown();\r\n                }\r\n            }\r\n            else if (event.which == 8) {\r\n                // NOTE: this will process backspace only if there are no text in the input field\r\n                // If user will find this inconvinient, we will need to calculate something like this\r\n                // this.isBackspaceAtStartPoint = (this.filterInput.selectionStart == 0 && this.filterInput.selectionEnd == 0);\r\n                if (!this.filterInput.value)\r\n                {\r\n                    let $penult = this.$(this.selectedPanel).find(\"LI:last\").prev();\r\n                    if ($penult.length){\r\n                        let removeItem = $penult.data(\"option-remove\");\r\n                        removeItem();\r\n                    }\r\n                    this.updateDropDownPosition(false);\r\n                }\r\n            }\r\n\r\n            if ([38, 40, 13, 9].indexOf(event.which)==-1)\r\n                this.resetDropDownMenuHover();\r\n        });\r\n        $filterInput.on(\"keyup\", (event) => {\r\n            if (event.which == 13 || event.which == 9 ) {\r\n                if (this.hoveredDropDownItem) {\r\n                    let $hoveredDropDownItem = this.$(this.hoveredDropDownItem);\r\n                    let toggleItem =  $hoveredDropDownItem.data(\"option-toggle\");\r\n                    toggleItem();\r\n                    this.closeDropDown();\r\n                } else {\r\n                    let text = this.filterInput.value.trim().toLowerCase();\r\n                    let dropDownItems = this.dropDownMenu.querySelectorAll(\"LI\");\r\n                    let dropDownItem = null;\r\n                    for (let i = 0; i < dropDownItems.length; ++i) {\r\n                        let it = dropDownItems[i];\r\n                        if (it.textContent.trim().toLowerCase() == text)\r\n                        {\r\n                            dropDownItem=it;\r\n                            break;\r\n                        }\r\n                    }\r\n                    if (dropDownItem) {\r\n                        let $dropDownItem = this.$(dropDownItem);\r\n                        let option = $dropDownItem.data(\"option\");\r\n                        if (!option.selected){\r\n                            let toggle = $dropDownItem.data(\"option-toggle\");\r\n                            toggle();\r\n                        }\r\n                        this.clearFilterInput(true);\r\n                    }\r\n                }\r\n            }\r\n            else if (event.which == 27) { // escape\r\n                this.closeDropDown();\r\n            }\r\n        });\r\n        $filterInput.on('input', () => {\r\n            this.input(true);\r\n        });\r\n    }\r\n}\r\n\r\nexport default MultiSelect;\r\n","function AddToJQueryPrototype(pluginName, createPlugin, $){\r\n    const firstChar = pluginName.charAt(0);\r\n    const firstCharLower = firstChar.toLowerCase();\r\n    if (firstCharLower == firstChar) {\r\n        throw new TypeError(`Plugin name '${pluginName}' should be started from upper case char`)\r\n    }\r\n    const prototypableName = firstCharLower + pluginName.slice(1)\r\n    const noConflictPrototypable = $.fn[prototypableName];\r\n    const dataKey = `DashboardCode.${pluginName}`;\r\n\r\n    function prototypable(options) {\r\n        return this.each( function () {\r\n            let $e = $(this);\r\n            let instance = $e.data(dataKey)\r\n            let isMethodName = typeof options === 'string';\r\n            if (!instance) {\r\n                if (isMethodName && /Dispose/.test(options)) {\r\n                    return;\r\n                }\r\n                const optionsObject = (typeof options === 'object')?options:null;\r\n\r\n                instance = createPlugin(this, optionsObject,\r\n                    () => {\r\n                        $e.removeData(dataKey)\r\n                    });\r\n                $e.data(dataKey, instance);\r\n            }\r\n\r\n            if (isMethodName) {\r\n                let methodName = options;\r\n                if (typeof instance[methodName] === 'undefined') {\r\n                    throw new TypeError(`No method named '${methodName}'`)\r\n                }\r\n                instance[methodName]()\r\n            }\r\n        })\r\n    }\r\n\r\n    $.fn[prototypableName] = prototypable;\r\n\r\n    // pluginName with first capitalized letter - return plugin instance for 1st $selected item\r\n    $.fn[pluginName] = function () {\r\n        return $(this).data(dataKey);\r\n    };\r\n\r\n    $.fn[prototypableName].noConflict = function () {\r\n        $.fn[prototypableName] = noConflictPrototypable\r\n        return prototypable;\r\n    }\r\n}\r\n\r\nexport default AddToJQueryPrototype\r\n","function disableButton($selectedPanel, isDisabled){\r\n    $selectedPanel.find('BUTTON').prop(\"disabled\", isDisabled);\r\n}\r\n\r\n// addClass, removeClass, css, siblings('label'), hasClass, find('BUTTON').prop(..)\r\nclass Bs4Adapter {\r\n\r\n    constructor(\r\n        stylingAdapter, configuration, $){\r\n        const defaults = {\r\n            containerClass: 'dashboardcode-bsmultiselect',\r\n            dropDownMenuClass: 'dropdown-menu',\r\n            dropDownItemClass:  'px-2',\r\n            dropDownItemHoverClass: 'text-primary bg-light',\r\n            selectedPanelClass: 'form-control',\r\n            selectedItemClass: 'badge',\r\n            removeSelectedItemButtonClass: 'close',\r\n            filterInputItemClass: '',\r\n            filterInputClass: ''\r\n        }\r\n        let tmp = $.extend({}, defaults, configuration);\r\n        this.configuration = $.extend(configuration, tmp);\r\n        this.$ = $;\r\n        this.stylingAdapter = stylingAdapter;\r\n        this.bs4LabelDispose = null;\r\n        \r\n        this.createDropDownItemContent = (configuration, $dropDownItem, option) => {\r\n            let checkBoxId = this.configuration.createCheckBoxId(configuration, option);\r\n            let $dropDownItemContent= this.$(`<div class=\"custom-control custom-checkbox\">\r\n                <input type=\"checkbox\" class=\"custom-control-input\">\r\n                <label class=\"custom-control-label\"></label>\r\n            </div>`);\r\n            $dropDownItemContent.appendTo($dropDownItem);\r\n            let $checkBox = $dropDownItemContent.find(`INPUT[type=\"checkbox\"]`);\r\n            $checkBox.attr('id',  checkBoxId);\r\n            let $checkBoxLabel = $dropDownItemContent.find(`label`);\r\n            $checkBoxLabel.attr('for',  checkBoxId);\r\n            $checkBoxLabel.text(option.text);\r\n            $dropDownItem.addClass(configuration.dropDownItemClass);\r\n    \r\n            let dropDownItem = $dropDownItem.get(0);\r\n            let dropDownItemContent = $dropDownItemContent.get(0);\r\n     \r\n            let stylingAdapter = this.stylingAdapter;\r\n            return { \r\n                select(isSelected){ $checkBox.prop('checked', isSelected); }, \r\n                disable(isDisabled){ $checkBox.prop('disabled', isDisabled); },\r\n                disabledStyle(disabledStyle){ stylingAdapter.DisabledStyle($checkBox, disabledStyle); },\r\n                onSelected(toggle) {\r\n                        $checkBox.on(\"change\", toggle)\r\n                        $dropDownItem.on(\"click\", (e) => {\r\n                            if (e.target == dropDownItem || e.target == dropDownItemContent)\r\n                                toggle();\r\n                        })\r\n                }\r\n            }\r\n        }\r\n\r\n        this.createSelectedItemContent = (configuration, $selectedItem, optionItem, removeSelectedItem, controlDisabled) => {\r\n            let $content = this.$(`<span/>`).text(optionItem.text);\r\n            $content.appendTo($selectedItem);\r\n            if (optionItem.disabled)\r\n                this.stylingAdapter.DisableSelectedItemContent($content);\r\n            let $button = this.$('<button aria-label=\"Close\" tabIndex=\"-1\" type=\"button\"><span aria-hidden=\"true\">&times;</span></button>')\r\n                // bs 'close' class that will be added to button set the float:right, therefore it impossible to configure no-warp policy \r\n                // with .css(\"white-space\", \"nowrap\") or  .css(\"display\", \"inline-block\"); TODO: migrate to flex? \r\n                .css(\"float\", \"none\")\r\n    \r\n                // what is a problem with calling removeSelectedItem directly (not using  setTimeout(removeSelectedItem, 0)):\r\n                // consider situation \"MultiSelect\" on DROPDOWN (that should be closed on the click outside dropdown)\r\n                // therefore we aslo have document's click's handler where we decide to close or leave the DROPDOWN open.\r\n                // because of the event's bubling process removeSelectedItem runs first. \r\n                // that means the event's target element on which we click (the x button) will be removed from the DOM together with badge \r\n                // before we could analize is it belong to our dropdown or not.\r\n                // important 1: we can't just the stop propogation using stopPropogate because click outside dropdown on the similar \r\n                // component that use stopPropogation will not close dropdown (error, dropdown should be closed)\r\n                // important 2: we can't change the dropdown's event handler to leave dropdown open if event's target is null because of\r\n                // the situation described above: click outside dropdown on the same component.\r\n                // Alternatively it could be possible to use stopPropogate but together create custom click event setting new target that belomgs to DOM (e.g. panel)\r\n                \r\n                .on(\"click\", () => setTimeout(removeSelectedItem, 0)) \r\n                .appendTo($selectedItem)\r\n                .prop(\"disabled\", controlDisabled)\r\n            $selectedItem.addClass(configuration.selectedItemClass);\r\n            $button.addClass(configuration.removeSelectedItemButtonClass) // bs close class set the float:right\r\n            if (this.stylingAdapter.CreateSelectedItemContent)\r\n                this.stylingAdapter.CreateSelectedItemContent($selectedItem, $button)\r\n        }\r\n    }\r\n   \r\n\r\n    // ------------------------------------------------------------------------------------------------\r\n    Init(dom){\r\n        dom.container.addClass(this.configuration.containerClass);\r\n        dom.selectedPanel.addClass(this.configuration.selectedPanelClass);\r\n        dom.dropDownMenu.addClass(this.configuration.dropDownMenuClass);\r\n        dom.filterInputItem.addClass(this.configuration.filterInputItemClass);\r\n        dom.filterInput.addClass(this.configuration.filterInputClass);\r\n        if (this.stylingAdapter.OnInit)\r\n            this.stylingAdapter.OnInit(dom)\r\n        this.bs4LabelDispose = this.HandleLabel(dom.filterInput);\r\n    }\r\n\r\n    HandleLabel($filterInput){\r\n        var label = this.configuration.label;\r\n        if (label!=null) {\r\n            var newForId = this.configuration.createInputId(this.configuration);\r\n            var backupForId =  label.getAttribute('for');\r\n            $filterInput.attr('id', newForId);\r\n            label.setAttribute('for',newForId);\r\n            return () => {\r\n                label.setAttribute('for',backupForId);\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    Dispose(){\r\n        if (this.bs4LabelDispose)\r\n            this.bs4LabelDispose();\r\n    }\r\n\r\n    // ------------------------------------------------------------------------------------------------\r\n    CreateDropDownItemContent($dropDownItem, option){\r\n        return this.createDropDownItemContent(this.configuration, $dropDownItem, option);\r\n    }\r\n\r\n    CreateSelectedItemContent($selectedItem, optionItem, removeSelectedItem, controlDisabled){\r\n        return this.createSelectedItemContent(this.configuration, $selectedItem, optionItem, removeSelectedItem, controlDisabled);\r\n    }\r\n\r\n    // -----------------------\r\n    IsClickToOpenDropdown(event){\r\n        const target = event.target;\r\n        const nodeName = target.nodeName;\r\n        return !(nodeName == \"BUTTON\" || (nodeName == \"SPAN\" && target.parentElement.nodeName == \"BUTTON\"))\r\n    }\r\n\r\n    UpdateIsValid($selectedPanel){\r\n        if (this.configuration.getIsValid()){\r\n            $selectedPanel.addClass(\"is-valid\");\r\n        }\r\n\r\n        if (this.configuration.getIsInvalid()){\r\n            $selectedPanel.addClass(\"is-invalid\");\r\n        }\r\n    }\r\n\r\n    UpdateSize($selectedPanel){\r\n        if(this.stylingAdapter.UpdateSize)\r\n            this.stylingAdapter.UpdateSize($selectedPanel)\r\n    }\r\n\r\n    HoverIn($dropDownItem){\r\n        $dropDownItem.addClass(this.configuration.dropDownItemHoverClass);\r\n    }\r\n\r\n    HoverOut($dropDownItem){\r\n        $dropDownItem.removeClass(this.configuration.dropDownItemHoverClass);\r\n    }\r\n\r\n    Enable($selectedPanel){\r\n        this.stylingAdapter.Enable($selectedPanel)\r\n        disableButton($selectedPanel, false)\r\n    }\r\n\r\n    Disable($selectedPanel){\r\n        this.stylingAdapter.Disable($selectedPanel)\r\n        disableButton($selectedPanel, true)\r\n    }\r\n\r\n    FocusIn($selectedPanel){\r\n        this.stylingAdapter.FocusIn($selectedPanel)\r\n    }\r\n\r\n    FocusOut($selectedPanel){\r\n        this.stylingAdapter.FocusOut($selectedPanel)\r\n    }\r\n}\r\n\r\nexport default Bs4Adapter;\r\n","class OptionsAdapterElement {\r\n    constructor(selectElement, configuration, $) {\r\n        var $selectElement = $(selectElement);\r\n        \r\n        configuration.getIsValid=()=>$selectElement.hasClass(\"is-valid\");\r\n        configuration.getIsInvalid=()=>$selectElement.hasClass(\"is-invalid\");\r\n        configuration.createInputId=(configuration)=>`${configuration.containerClass}-generated-filter-${selectElement.name.toLowerCase()}-id`;\r\n        configuration.label=null;\r\n        let $formGroup = $selectElement.closest('.form-group');\r\n        if ($formGroup.length == 1) {\r\n            let $label = $formGroup.find(`label[for=\"${selectElement.id}\"]`);\r\n            if ($label.length>0)\r\n            {   \r\n                let label = $label.get(0);\r\n                let forId = label.getAttribute('for');\r\n                if (forId == selectElement.id) {\r\n                    configuration.label = label;\r\n                }\r\n            }   \r\n        }\r\n        configuration.createCheckBoxId=(configuration, option)=>`${configuration.containerClass}-${selectElement.name.toLowerCase()}-generated-checkbox-${option.value.toLowerCase()}-id`;\r\n\r\n        this.init = (ms) => {\r\n            selectElement.style.display='none';\r\n            let container = document.createElement(\"div\");\r\n  \r\n            let {$container, $selectedPanel, $dropDownMenu, $filterInput} = ms.fillContainer(container, \r\n                ()=>container.parentNode.removeChild(container));\r\n            $container.insertAfter(selectElement);\r\n            ms.init($container, $selectedPanel, $dropDownMenu, $filterInput, \r\n                () => {\r\n                    $selectElement.trigger('change');\r\n                    $selectElement.trigger( \"multiselect:change\" );\r\n                }, \r\n                () => $selectElement.find('OPTION'), \r\n                () => selectElement.disabled);\r\n        }\r\n    }\r\n}\r\n\r\nexport default OptionsAdapterElement;\r\n","class OptionsAdapterJson {\r\n    constructor(container, configuration) {\r\n\r\n        configuration.getIsValid=configuration.hasOwnProperty(\"getIsValid\")?configuration.getIsValid:()=>false;\r\n        configuration.getIsInvalid=configuration.hasOwnProperty(\"getIsInvalid\")?configuration.getIsInvalid:()=>false;\r\n        configuration.createInputId=(configuration)=>`${configuration.containerClass}-generated-filter-${container.id}`;\r\n        configuration.label=configuration.hasOwnProperty(\"label\")?configuration.label:null;\r\n        configuration.createCheckBoxId=(configuration, option) =>`${configuration.containerClass}-${container.id}-generated-checkbox-${option.value.toLowerCase()}-id`;\r\n\r\n        this.init = (ms) => {\r\n            let {$container, $selectedPanel, $dropDownMenu, $filterInput} = ms.fillContainer(container,\r\n                ()=> {\r\n                    while (container.firstChild) container.removeChild(container.firstChild);\r\n                });\r\n            ms.init($container, $selectedPanel, $dropDownMenu, $filterInput, \r\n                () => {\r\n                    $container.trigger( \"multiselect:change\" );\r\n                }, \r\n                () => configuration.options, \r\n                configuration.hasOwnProperty(\"getDisabled\")?configuration.getDisabled:()=>true);\r\n        }\r\n    }\r\n}\r\n\r\nexport default OptionsAdapterJson;\r\n","import $ from 'jquery'\r\nimport Bs4AdapterCss from './Bs4AdapterCss'\r\nimport Bs4AdapterJs from './Bs4AdapterJs'\r\nimport MultiSelect from './MultiSelect'\r\nimport AddToJQueryPrototype from './AddToJQueryPrototype'\r\nimport Bs4Adapter from './Bs4Adapter';\r\nimport OptionsAdapterElement from './OptionsAdapterElement';\r\nimport OptionsAdapterJson from './OptionsAdapterJson';\r\n\r\n(\r\n    (window, $) => {\r\n        AddToJQueryPrototype('BsMultiSelect',\r\n            (element, configuration, onDispose) => {\r\n                let optionsAdapter = null;\r\n                configuration= $.extend({}, configuration);\r\n                if (configuration.optionsAdapter)\r\n                    optionsAdapter = configuration.optionsAdapter;\r\n                else\r\n                {\r\n                    optionsAdapter = configuration.options\r\n                        ? new OptionsAdapterJson(element, configuration)\r\n                        : new OptionsAdapterElement(element, configuration, $);\r\n                }\r\n\r\n                let adapter=null;\r\n                if (configuration.adapter)\r\n                    adapter = configuration.adapter;\r\n                else\r\n                {\r\n                    let stylingAdapter = configuration.useCss\r\n                        ? new Bs4AdapterCss(configuration, $)\r\n                        : new Bs4AdapterJs(configuration, $);\r\n                    adapter = new Bs4Adapter(stylingAdapter, configuration, $);\r\n                }\r\n\r\n                let multiSelect = new MultiSelect(optionsAdapter, adapter, configuration, onDispose, window, $);\r\n                return multiSelect;\r\n            }, $);\r\n    }\r\n)(window, $)\r\n"],"names":["Bs4AdapterCss","configuration","$","defaults","selectedPanelFocusClass","selectedPanelDisabledClass","selectedItemContentDisabledClass","dropDownItemDisabledClass","tmp","extend","DisableSelectedItemContent","$content","addClass","DisabledStyle","$checkBox","isDisbaled","removeClass","Enable","$selectedPanel","Disable","FocusIn","FocusOut","defSelectedPanelStyle","defSelectedItemStyle","defRemoveSelectedItemButtonStyle","Bs4AdapterJs","selectedPanelDefMinHeight","selectedPanelLgMinHeight","selectedPanelSmMinHeight","selectedPanelDisabledBackgroundColor","selectedPanelFocusBorderColor","selectedPanelFocusBoxShadow","selectedPanelFocusValidBoxShadow","selectedPanelFocusInvalidBoxShadow","filterInputColor","selectedItemContentDisabledOpacity","dropdDownLabelDisabledColor","OnInit","dom","selectedPanel","css","filterInput","CreateSelectedItemContent","$selectedItem","$button","siblings","UpdateSize","hasClass","defSelectedPanelStyleSys","defFilterInputStyleSys","defDropDownMenuStyleSys","MultiSelect","optionsAdapter","adapter","onDispose","window","Popper","TypeError","document","container","filterInputItem","dropDownMenu","popper","getDisabled","selectedPanelClick","documentMouseup","containerMousedown","documentMouseup2","disabled","filterInputItemOffsetLeft","skipFocusout","hoveredDropDownItem","hoveredDropDownIndex","hasDropDownVisible","$document","init","updateDropDownPosition","force","offsetLeft","update","hideDropDown","style","display","showDropDown","resetDropDownMenuHover","HoverOut","filterDropDownMenu","text","value","trim","toLowerCase","visible","find","each","i","dropDownMenuItem","$dropDownMenuItem","show","itemText","data","option","selected","hidden","indexOf","hide","visibleNodeListArray","getVisibleNodeListArray","hoverInInternal","clearFilterInput","updatePosition","input","closeDropDown","appendDropDownItem","optionElement","onChange","isHidden","$dropDownItem","prop","appendTo","adjustDropDownItem","CreateDropDownItemContent","isDisabled","isSelected","disabledStyle","disable","onSelected","toggleItem","focus","selectItem","doPublishEvents","adjustPair","toggle","remove","select","removeItem","removeItemAndCloseDropDown","insertBefore","mouseover","HoverIn","mouseout","toArray","index","keydownArrow","down","length","newIndex","forceUpdatePosition","width","Update","UpdateIsValid","UpdateSizeImpl","UpdateDisabledImpl","Dispose","unbind","destroy","removeContainer","UpdateDisabled","$container","mousedown","mouseup","click","fillContainer","createElement","$filterInputItem","get","$filterInput","$dropDownMenu","event","target","contains","nodeName","val","IsClickToOpenDropdown","Init","getOptions","placement","modifiers","preventOverflow","enabled","flip","options","el","focusin","focusout","on","which","preventDefault","$penult","prev","$hoveredDropDownItem","dropDownItems","querySelectorAll","dropDownItem","it","textContent","AddToJQueryPrototype","pluginName","createPlugin","firstChar","charAt","firstCharLower","prototypableName","slice","noConflictPrototypable","fn","dataKey","prototypable","$e","instance","isMethodName","test","optionsObject","removeData","methodName","noConflict","disableButton","Bs4Adapter","stylingAdapter","containerClass","dropDownMenuClass","dropDownItemClass","dropDownItemHoverClass","selectedPanelClass","selectedItemClass","removeSelectedItemButtonClass","filterInputItemClass","filterInputClass","bs4LabelDispose","createDropDownItemContent","checkBoxId","createCheckBoxId","$dropDownItemContent","attr","$checkBoxLabel","dropDownItemContent","e","createSelectedItemContent","optionItem","removeSelectedItem","controlDisabled","setTimeout","HandleLabel","label","newForId","createInputId","backupForId","getAttribute","setAttribute","parentElement","getIsValid","getIsInvalid","OptionsAdapterElement","selectElement","$selectElement","name","$formGroup","closest","$label","id","forId","ms","parentNode","removeChild","insertAfter","trigger","OptionsAdapterJson","hasOwnProperty","firstChild","element","useCss","multiSelect"],"mappings":"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"}